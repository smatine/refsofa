{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _comparison = require('../comparison');\n\nvar Comparator = _interopRequireWildcard(_comparison);\n\nvar _const = require('../const');\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/* eslint react/require-default-props: 0 */\n\n/* eslint jsx-a11y/no-static-element-interactions: 0 */\n\n/* eslint no-return-assign: 0 */\n\n/* eslint prefer-template: 0 */\n\n\nvar legalComparators = [Comparator.EQ, Comparator.NE, Comparator.GT, Comparator.GE, Comparator.LT, Comparator.LE];\n\nfunction dateParser(d) {\n  return d.getFullYear() + '-' + ('0' + (d.getMonth() + 1)).slice(-2) + '-' + ('0' + d.getDate()).slice(-2);\n}\n\nvar DateFilter = function (_Component) {\n  _inherits(DateFilter, _Component);\n\n  function DateFilter(props) {\n    _classCallCheck(this, DateFilter);\n\n    var _this = _possibleConstructorReturn(this, (DateFilter.__proto__ || Object.getPrototypeOf(DateFilter)).call(this, props));\n\n    _this.timeout = null;\n    _this.comparators = props.comparators || legalComparators;\n    _this.applyFilter = _this.applyFilter.bind(_this);\n    _this.onChangeDate = _this.onChangeDate.bind(_this);\n    _this.onChangeComparator = _this.onChangeComparator.bind(_this);\n    return _this;\n  }\n\n  _createClass(DateFilter, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var getFilter = this.props.getFilter;\n      var comparator = this.dateFilterComparator.value;\n      var date = this.inputDate.value;\n\n      if (comparator && date) {\n        this.applyFilter(date, comparator, true);\n      } // export onFilter function to allow users to access\n\n\n      if (getFilter) {\n        getFilter(function (filterVal) {\n          _this2.dateFilterComparator.value = filterVal.comparator;\n          _this2.inputDate.value = dateParser(filterVal.date);\n\n          _this2.applyFilter(filterVal.date, filterVal.comparator);\n        });\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.timeout) clearTimeout(this.timeout);\n    }\n  }, {\n    key: 'onChangeDate',\n    value: function onChangeDate(e) {\n      var comparator = this.dateFilterComparator.value;\n      var filterValue = e.target.value;\n      this.applyFilter(filterValue, comparator);\n    }\n  }, {\n    key: 'onChangeComparator',\n    value: function onChangeComparator(e) {\n      var value = this.inputDate.value;\n      var comparator = e.target.value;\n      this.applyFilter(value, comparator);\n    }\n  }, {\n    key: 'getComparatorOptions',\n    value: function getComparatorOptions() {\n      var optionTags = [];\n      var withoutEmptyComparatorOption = this.props.withoutEmptyComparatorOption;\n\n      if (!withoutEmptyComparatorOption) {\n        optionTags.push(_react2.default.createElement('option', {\n          key: '-1'\n        }));\n      }\n\n      for (var i = 0; i < this.comparators.length; i += 1) {\n        optionTags.push(_react2.default.createElement('option', {\n          key: i,\n          value: this.comparators[i]\n        }, this.comparators[i]));\n      }\n\n      return optionTags;\n    }\n  }, {\n    key: 'getDefaultDate',\n    value: function getDefaultDate() {\n      var defaultDate = '';\n      var defaultValue = this.props.defaultValue;\n\n      if (defaultValue && defaultValue.date) {\n        // Set the appropriate format for the input type=date, i.e. \"YYYY-MM-DD\"\n        defaultDate = dateParser(new Date(defaultValue.date));\n      }\n\n      return defaultDate;\n    }\n  }, {\n    key: 'applyFilter',\n    value: function applyFilter(value, comparator, isInitial) {\n      // if (!comparator || !value) {\n      //  return;\n      // }\n      var _props = this.props,\n          column = _props.column,\n          onFilter = _props.onFilter,\n          delay = _props.delay;\n\n      var execute = function execute() {\n        // Incoming value should always be a string, and the defaultDate\n        // above is implemented as an empty string, so we can just check for that.\n        // instead of parsing an invalid Date. The filter function will interpret\n        // null as an empty date field\n        var date = value === '' ? null : new Date(value);\n        onFilter(column, _const.FILTER_TYPE.DATE, isInitial)({\n          date: date,\n          comparator: comparator\n        });\n      };\n\n      if (delay) {\n        this.timeout = setTimeout(function () {\n          execute();\n        }, delay);\n      } else {\n        execute();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this3 = this;\n\n      var _props2 = this.props,\n          placeholder = _props2.placeholder,\n          text = _props2.column.text,\n          style = _props2.style,\n          comparatorStyle = _props2.comparatorStyle,\n          dateStyle = _props2.dateStyle,\n          className = _props2.className,\n          comparatorClassName = _props2.comparatorClassName,\n          dateClassName = _props2.dateClassName,\n          defaultValue = _props2.defaultValue;\n      return _react2.default.createElement('div', {\n        onClick: function onClick(e) {\n          return e.stopPropagation();\n        },\n        className: 'filter date-filter ' + className,\n        style: style\n      }, _react2.default.createElement('select', {\n        ref: function ref(n) {\n          return _this3.dateFilterComparator = n;\n        },\n        style: comparatorStyle,\n        className: 'date-filter-comparator form-control ' + comparatorClassName,\n        onChange: this.onChangeComparator,\n        defaultValue: defaultValue ? defaultValue.comparator : ''\n      }, this.getComparatorOptions()), _react2.default.createElement('input', {\n        ref: function ref(n) {\n          return _this3.inputDate = n;\n        },\n        className: 'filter date-filter-input form-control ' + dateClassName,\n        style: dateStyle,\n        type: 'date',\n        onChange: this.onChangeDate,\n        placeholder: placeholder || 'Enter ' + text + '...',\n        defaultValue: this.getDefaultDate()\n      }));\n    }\n  }]);\n\n  return DateFilter;\n}(_react.Component);\n\nDateFilter.propTypes = {\n  onFilter: _propTypes.PropTypes.func.isRequired,\n  column: _propTypes.PropTypes.object.isRequired,\n  delay: _propTypes.PropTypes.number,\n  defaultValue: _propTypes.PropTypes.shape({\n    date: _propTypes.PropTypes.oneOfType([_propTypes.PropTypes.object]),\n    comparator: _propTypes.PropTypes.oneOf([].concat(legalComparators, ['']))\n  }),\n\n  /* eslint consistent-return: 0 */\n  comparators: function comparators(props, propName) {\n    if (!props[propName]) {\n      return;\n    }\n\n    for (var i = 0; i < props[propName].length; i += 1) {\n      var comparatorIsValid = false;\n\n      for (var j = 0; j < legalComparators.length; j += 1) {\n        if (legalComparators[j] === props[propName][i] || props[propName][i] === '') {\n          comparatorIsValid = true;\n          break;\n        }\n      }\n\n      if (!comparatorIsValid) {\n        return new Error('Date comparator provided is not supported.\\n          Use only ' + legalComparators);\n      }\n    }\n  },\n  placeholder: _propTypes.PropTypes.string,\n  withoutEmptyComparatorOption: _propTypes.PropTypes.bool,\n  style: _propTypes.PropTypes.object,\n  comparatorStyle: _propTypes.PropTypes.object,\n  dateStyle: _propTypes.PropTypes.object,\n  className: _propTypes.PropTypes.string,\n  comparatorClassName: _propTypes.PropTypes.string,\n  dateClassName: _propTypes.PropTypes.string,\n  getFilter: _propTypes.PropTypes.func\n};\nDateFilter.defaultProps = {\n  delay: 0,\n  defaultValue: {\n    date: undefined,\n    comparator: ''\n  },\n  withoutEmptyComparatorOption: false,\n  comparators: legalComparators,\n  placeholder: undefined,\n  style: undefined,\n  className: '',\n  comparatorStyle: undefined,\n  comparatorClassName: '',\n  dateStyle: undefined,\n  dateClassName: ''\n};\nexports.default = DateFilter;","map":null,"metadata":{},"sourceType":"script"}