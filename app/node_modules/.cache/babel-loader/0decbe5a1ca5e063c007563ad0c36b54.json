{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"C:\\\\ref\\\\referentiel\\\\app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"C:\\\\ref\\\\referentiel\\\\app\\\\src\\\\KmsEdit.js\";\nimport React, { Component } from 'react';\nimport { Link, withRouter } from 'react-router-dom';\nimport { Button, Container, Form, FormGroup, Input, Label, FormFeedback, FormText } from 'reactstrap';\nimport AppNavbar from './AppNavbar';\nimport Select from 'react-select';\nimport { API_BASE_URL } from './constants';\n\nvar KmsEdit =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(KmsEdit, _Component);\n\n  function KmsEdit(props) {\n    var _this;\n\n    _classCallCheck(this, KmsEdit);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(KmsEdit).call(this, props));\n    _this.emptyItem = {\n      alias: '',\n      account: {},\n      accounts: [],\n      accountId: '',\n      roles: [],\n      roless: [],\n      roleId: [],\n      text: '',\n      keyMaterialOrigin: 'Kms',\n      policy: {},\n      policys: [],\n      policyId: '',\n      users: [],\n      userss: [],\n      userId: [],\n      touched: {\n        alias: false,\n        accountId: false,\n        roleId: false,\n        keyMaterialOrigin: false,\n        policyId: false,\n        userId: false\n      }\n    };\n\n    _this.handleBlur = function (field) {\n      return function (evt) {\n        var item = _objectSpread({}, _this.state.item);\n\n        item.touched = _objectSpread({}, _this.state.item.touched, _defineProperty({}, field, true));\n\n        _this.setState({\n          item: item\n        });\n      };\n    };\n\n    _this.onOptionChange = function (selectName, selectedOption) {\n      var item = _this.state.item;\n      var options = selectedOption;\n      var values = [];\n\n      if (selectName === 'roleId') {\n        for (var i = 0, l = options.length; i < l; i++) {\n          if (item.roless && item.roless.length) {\n            item.roless.map(function (s) {\n              if (s.id == options[i].value) {\n                values.push({\n                  \"id\": s.id\n                });\n              }\n            });\n          }\n        }\n\n        item.roles = values;\n      }\n\n      if (selectName === 'userId') {\n        for (var i = 0, l = options.length; i < l; i++) {\n          if (item.userss && item.userss.length) {\n            item.userss.map(function (s) {\n              if (s.id == options[i].value) {\n                values.push({\n                  \"id\": s.id\n                });\n              }\n            });\n          }\n        }\n\n        item.users = values;\n      }\n\n      _this.setState({\n        item: item\n      });\n    };\n\n    _this.state = {\n      item: _this.emptyItem\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleBlur = _this.handleBlur.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(KmsEdit, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var _this2 = this;\n\n        var kms, account, item, values, _kms;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.props.match.params.id !== 'new')) {\n                  _context.next = 26;\n                  break;\n                }\n\n                _context.next = 3;\n                return fetch(\"\".concat(API_BASE_URL, \"/kmss/\").concat(this.props.match.params.id));\n\n              case 3:\n                _context.next = 5;\n                return _context.sent.json();\n\n              case 5:\n                kms = _context.sent;\n                kms.touched = {\n                  alias: false,\n                  accountId: false,\n                  roleId: false,\n                  keyMaterialOrigin: false,\n                  policyId: false,\n                  userId: false\n                };\n                this.setState({\n                  item: kms\n                });\n                account = {};\n                _context.next = 11;\n                return fetch(API_BASE_URL + \"/accounts/\" + kms.account.id).then(function (result) {\n                  return result.json();\n                }).then(function (jsonResult) {\n                  account = jsonResult;\n                  fetch(API_BASE_URL + '/accounts/' + account.id + '/roles').then(function (result) {\n                    return result.json();\n                  }).then(function (jsonResult) {\n                    var item = _objectSpread({}, _this2.state.item);\n\n                    item.roless = jsonResult;\n\n                    _this2.setState({\n                      item: item\n                    });\n                  });\n                  fetch(API_BASE_URL + '/accounts/' + account.id + '/users').then(function (result) {\n                    return result.json();\n                  }).then(function (jsonResult) {\n                    var item = _objectSpread({}, _this2.state.item);\n\n                    item.userss = jsonResult;\n\n                    _this2.setState({\n                      item: item\n                    });\n                  });\n                  fetch(API_BASE_URL + '/accounts/' + account.id + '/policys').then(function (result) {\n                    return result.json();\n                  }).then(function (jsonResult) {\n                    var item = _objectSpread({}, _this2.state.item);\n\n                    item.policys = jsonResult;\n\n                    _this2.setState({\n                      item: item\n                    });\n                  });\n                });\n\n              case 11:\n                item = _objectSpread({}, this.state.item);\n                item.accountId = kms.account.id;\n                item.policyId = kms.policy.id;\n                values = [];\n                if (item.roles) item.roles.map(function (s) {\n                  values.push({\n                    \"id\": s.id\n                  });\n                });\n                item.roles = values;\n                values = [];\n                if (item.users) item.users.map(function (s) {\n                  values.push({\n                    \"id\": s.id\n                  });\n                });\n                item.users = values;\n                values = [];\n                if (item.policys) item.policys.map(function (s) {\n                  values.push({\n                    \"id\": s.id\n                  });\n                });\n                item.policys = values;\n                this.setState({\n                  item: item\n                });\n                _context.next = 29;\n                break;\n\n              case 26:\n                _kms = {\n                  alias: '',\n                  account: {},\n                  accounts: [],\n                  accountId: '',\n                  roles: [],\n                  roless: [],\n                  roleId: [],\n                  text: '',\n                  keyMaterialOrigin: 'Kms',\n                  policy: {},\n                  policys: [],\n                  policyId: '',\n                  touched: {\n                    alias: false,\n                    accountId: false,\n                    roleId: false,\n                    keyMaterialOrigin: false,\n                    policyId: false,\n                    userId: false\n                  }\n                };\n                _kms.touched = {\n                  alias: false,\n                  accountId: false,\n                  roleId: false,\n                  keyMaterialOrigin: false,\n                  policyId: false,\n                  userId: false\n                };\n                this.setState({\n                  item: _kms\n                });\n\n              case 29:\n                _context.next = 31;\n                return fetch(API_BASE_URL + '/accounts').then(function (result) {\n                  return result.json();\n                }).then(function (jsonResult) {\n                  var item = _objectSpread({}, _this2.state.item);\n\n                  item.accounts = jsonResult;\n\n                  _this2.setState({\n                    item: item\n                  });\n                });\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      var _this3 = this;\n\n      var target = event.target;\n      var value = target.value;\n      var name = target.name;\n\n      var item = _objectSpread({}, this.state.item);\n\n      item[name] = value;\n      this.setState({\n        item: item\n      });\n\n      if (name === 'accessType') {\n        if (value === 'Kms') {\n          item.keyMaterialOrigin = 'Kms';\n        } else {\n          item.keyMaterialOrigin = 'External';\n        }\n      }\n\n      if (name === 'accountId') {\n        var account = {};\n        fetch(API_BASE_URL + \"/accounts/\" + item.accountId).then(function (result) {\n          return result.json();\n        }).then(function (jsonResult) {\n          account = jsonResult;\n          fetch(API_BASE_URL + '/accounts/' + account.id + '/roles').then(function (result) {\n            return result.json();\n          }).then(function (jsonResult) {\n            var item = _objectSpread({}, _this3.state.item);\n\n            item.roless = jsonResult;\n\n            _this3.setState({\n              item: item\n            });\n          });\n          fetch(API_BASE_URL + '/accounts/' + account.id + '/users').then(function (result) {\n            return result.json();\n          }).then(function (jsonResult) {\n            var item = _objectSpread({}, _this3.state.item);\n\n            item.userss = jsonResult;\n\n            _this3.setState({\n              item: item\n            });\n          });\n          fetch(API_BASE_URL + '/accounts/' + account.id + '/policys').then(function (result) {\n            return result.json();\n          }).then(function (jsonResult) {\n            var item = _objectSpread({}, _this3.state.item);\n\n            item.policys = jsonResult;\n\n            _this3.setState({\n              item: item\n            });\n          });\n        });\n      }\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function () {\n      var _handleSubmit = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(event) {\n        var item, errors, isDisabled, hist, values;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.preventDefault();\n                item = this.state.item;\n                item.touched = {\n                  alias: true,\n                  accountId: true,\n                  roleId: true,\n                  keyMaterialOrigin: true,\n                  policyId: true,\n                  userId: true\n                };\n                errors = this.validate(item.alias, item.accountId, item.roleId, item.keyMaterialOrigin, item.policyId, item.userId);\n                isDisabled = Object.keys(errors).some(function (x) {\n                  return errors[x];\n                });\n\n                if (!isDisabled) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                this.forceUpdate();\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                hist = API_BASE_URL + '/kmss';\n                item.account = {\n                  id: item.accountId\n                };\n                item.policy = {\n                  id: item.policyId\n                };\n                values = [];\n                item.users.map(function (s) {\n                  values.push({\n                    \"id\": s.id\n                  });\n                });\n                item.users = values;\n                values = [];\n                item.roles.map(function (s) {\n                  values.push({\n                    \"id\": s.id\n                  });\n                });\n                item.roles = values;\n                _context2.next = 19;\n                return fetch(item.id ? API_BASE_URL + '/accounts/' + item.account.id + '/kmss/' + item.id : API_BASE_URL + '/accounts/' + item.account.id + '/kmss', {\n                  method: item.id ? 'PUT' : 'POST',\n                  headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                  },\n                  body: JSON.stringify(item)\n                });\n\n              case 19:\n                this.props.history.push(hist);\n\n              case 20:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function handleSubmit(_x) {\n        return _handleSubmit.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"validate\",\n    value: function validate(alias, accountId, roleId, keyMaterialOrigin, policyId, userId) {\n      var errors = {\n        alias: '',\n        accountId: '',\n        roleId: '',\n        keyMaterialOrigin: '',\n        policyId: '',\n        userId: ''\n      };\n\n      if (this.state.item.touched.alias && alias.length === 0) {\n        errors.alias = 'alias should not be null';\n        return errors;\n      }\n\n      if (this.state.item.touched.accountId && accountId.length === 0) {\n        errors.accountId = 'Vpc should not be null';\n        return errors;\n      }\n\n      if (this.state.item.touched.keyMaterialOrigin && keyMaterialOrigin.length === 0) {\n        errors.keyMaterialOrigin = 'keyMaterialOrigin should not be null';\n        return errors;\n      }\n      /*\r\n          if(this.state.item.touched.userId && userId.length === 0){\r\n            errors.userId = 'userId should not be null';\r\n            return errors;\r\n          }\r\n          */\n\n\n      if (this.state.item.touched.policyId && policyId.length === 0) {\n        errors.policyId = 'policyId should not be null';\n        return errors;\n      }\n      /*\r\n      if(this.state.item.touched.roleId  && this.state.item.roles.length === 0){\r\n        errors.roleId = 'Add roleId.';\r\n        return errors;\r\n      }\r\n      */\n\n\n      return errors;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var item = this.state.item;\n      var title = React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, item.id ? 'Edit Kms' : 'Add Kms');\n      var errors = this.validate(item.alias, item.accountId, item.roleId, item.keyMaterialOrigin, item.policyId, item.userId);\n      var isDisabled = Object.keys(errors).some(function (x) {\n        return errors[x];\n      });\n      var canc = API_BASE_URL + \"/kmss\";\n      var opts = [];\n\n      if (item.accounts && item.accounts.length) {\n        item.accounts.map(function (s) {\n          opts.push(React.createElement(\"option\", {\n            value: s.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 370\n            },\n            __self: this\n          }, s.id, \" \", s.name));\n        });\n      }\n\n      var account = item.accountId || '';\n      item.accountId = account;\n      var isUsed = false; //if(item.id !== '' && (item.kmss && item.kmss.length !== 0)  ) isUsed = true; \n\n      var optsp = [];\n      var optsps = [];\n\n      if (item.roless && item.roless.length) {\n        item.roless.map(function (s) {\n          if (item.roles && item.roles.length) item.roles.map(function (ss) {\n            if (s.id == ss.id) {\n              optsp.push({\n                value: s.id,\n                label: s.name\n              });\n            }\n          });\n          optsps.push({\n            value: s.id,\n            label: s.name\n          });\n        });\n      }\n\n      var optsu = [];\n      var optsus = [];\n\n      if (item.userss && item.userss.length) {\n        item.userss.map(function (s) {\n          if (item.users && item.users.length) item.users.map(function (ss) {\n            if (s.id == ss.id) {\n              optsu.push({\n                value: s.id,\n                label: s.name\n              });\n            }\n          });\n          optsus.push({\n            value: s.id,\n            label: s.name\n          });\n        });\n      }\n\n      var optpolicys = [];\n\n      if (item.policys && item.policys.length) {\n        item.policys.map(function (s) {\n          optpolicys.push(React.createElement(\"option\", {\n            value: s.id,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 408\n            },\n            __self: this\n          }, s.id, \" \", s.name));\n        });\n      }\n\n      var policy = item.policyId || '';\n      item.policyId = policy;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 414\n        },\n        __self: this\n      }, React.createElement(AppNavbar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 415\n        },\n        __self: this\n      }), React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 416\n        },\n        __self: this\n      }, title, React.createElement(Form, {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 419\n        },\n        __self: this\n      }, React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"alias\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421\n        },\n        __self: this\n      }, \"Alias (*)\"), React.createElement(Input, {\n        type: \"text\",\n        name: \"alias\",\n        id: \"alias\",\n        value: item.alias || '',\n        placeholder: \"Enter alias\",\n        disabled: isUsed,\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('alias'),\n        autoComplete: \"alias\",\n        valid: errors.alias === '',\n        invalid: errors.alias !== '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 422\n        },\n        __self: this\n      }), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 428\n        },\n        __self: this\n      }, errors.alias)), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"accountId\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 432\n        },\n        __self: this\n      }, \"Account (*)\"), React.createElement(Input, {\n        type: \"select\",\n        name: \"accountId\",\n        id: \"accountId\",\n        value: account,\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('accountId'),\n        disabled: isUsed,\n        valid: errors.accountId === '',\n        invalid: errors.accountId !== '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 433\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"\",\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 437\n        },\n        __self: this\n      }, \"Choose\"), opts), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440\n        },\n        __self: this\n      }, errors.accountId)), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 444\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"policyId\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 445\n        },\n        __self: this\n      }, \"Policy (*)\"), React.createElement(Input, {\n        type: \"select\",\n        name: \"policyId\",\n        id: \"policyId\",\n        value: policy,\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('policyId'),\n        disabled: isUsed,\n        valid: errors.policyId === '',\n        invalid: errors.policyId !== '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"\",\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 450\n        },\n        __self: this\n      }, \"Choose\"), optpolicys), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453\n        },\n        __self: this\n      }, errors.policyId)), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 456\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"roleId\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 457\n        },\n        __self: this\n      }, \"Roles\"), React.createElement(Select, {\n        name: \"roleId\",\n        id: \"roleId\",\n        placeholder: \"Enter roleId\",\n        isMulti: true,\n        disabled: isUsed,\n        value: optsp,\n        onChange: function onChange(e) {\n          return _this4.onOptionChange(\"roleId\", e);\n        },\n        onBlur: this.handleBlur('roleId'),\n        options: optsps,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 458\n        },\n        __self: this\n      }), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465\n        },\n        __self: this\n      }, errors.roleId)), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 468\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"userId\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 469\n        },\n        __self: this\n      }, \"Users\"), React.createElement(Select, {\n        name: \"userId\",\n        id: \"userId\",\n        placeholder: \"Enter userId\",\n        isMulti: true,\n        disabled: isUsed,\n        value: optsu,\n        onChange: function onChange(e) {\n          return _this4.onOptionChange(\"userId\", e);\n        },\n        onBlur: this.handleBlur('userId'),\n        options: optsus,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 470\n        },\n        __self: this\n      }), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 476\n        },\n        __self: this\n      }, errors.userId)), React.createElement(FormGroup, {\n        tag: \"fieldset\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 479\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"accessType\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480\n        },\n        __self: this\n      }, \"Key Material Origin\"), React.createElement(FormGroup, {\n        check: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 482\n        },\n        __self: this\n      }, React.createElement(Label, {\n        check: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 483\n        },\n        __self: this\n      }, React.createElement(Input, {\n        type: \"radio\",\n        name: \"accessType\",\n        id: \"accessType\",\n        value: \"Kms\",\n        checked: item.keyMaterialOrigin === 'Kms',\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('accessType'),\n        autoComplete: \"accessType\",\n        valid: errors.accessType === '',\n        invalid: errors.accessType !== '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 484\n        },\n        __self: this\n      }), ' ', \"Kms\")), React.createElement(FormGroup, {\n        check: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492\n        },\n        __self: this\n      }, React.createElement(Label, {\n        check: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 493\n        },\n        __self: this\n      }, React.createElement(Input, {\n        type: \"radio\",\n        name: \"accessType\",\n        id: \"accessType\",\n        value: \"External\",\n        checked: item.keyMaterialOrigin === 'External',\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('accessType'),\n        autoComplete: \"accessType\",\n        valid: errors.accessType === '',\n        invalid: errors.accessType !== '',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 494\n        },\n        __self: this\n      }), ' ', \"External\")), React.createElement(FormFeedback, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 503\n        },\n        __self: this\n      }, errors.accessType)), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }, React.createElement(Label, {\n        for: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 508\n        },\n        __self: this\n      }, \"Description\"), React.createElement(Input, {\n        type: \"text\",\n        name: \"text\",\n        id: \"text\",\n        value: item.text || '',\n        placeholder: \"Enter text\",\n        disabled: isUsed,\n        onChange: this.handleChange,\n        onBlur: this.handleBlur('text'),\n        autoComplete: \"text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 509\n        },\n        __self: this\n      })), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 519\n        },\n        __self: this\n      }, React.createElement(Button, {\n        color: \"primary\",\n        type: \"submit\",\n        disabled: isDisabled,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 520\n        },\n        __self: this\n      }, \"Save\"), ' ', React.createElement(Button, {\n        color: \"secondary\",\n        tag: Link,\n        to: canc,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 521\n        },\n        __self: this\n      }, \"Cancel\")))));\n    }\n  }]);\n\n  return KmsEdit;\n}(Component);\n\nexport default withRouter(KmsEdit);","map":{"version":3,"sources":["C:\\ref\\referentiel\\app\\src\\KmsEdit.js"],"names":["React","Component","Link","withRouter","Button","Container","Form","FormGroup","Input","Label","FormFeedback","FormText","AppNavbar","Select","API_BASE_URL","KmsEdit","props","emptyItem","alias","account","accounts","accountId","roles","roless","roleId","text","keyMaterialOrigin","policy","policys","policyId","users","userss","userId","touched","handleBlur","field","evt","item","state","setState","onOptionChange","selectName","selectedOption","options","values","i","l","length","map","s","id","value","push","handleChange","bind","handleSubmit","match","params","fetch","json","kms","then","result","jsonResult","event","target","name","preventDefault","errors","validate","isDisabled","Object","keys","some","x","forceUpdate","hist","method","headers","body","JSON","stringify","history","title","canc","opts","isUsed","optsp","optsps","ss","label","optsu","optsus","optpolicys","e","accessType"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport { Button, Container, Form, FormGroup, Input, Label, FormFeedback, FormText } from 'reactstrap';\r\nimport AppNavbar from './AppNavbar';\r\nimport Select from 'react-select';\r\nimport { API_BASE_URL } from './constants';\r\n\r\nclass KmsEdit extends Component {\r\n\r\n  emptyItem = {\r\n    alias: '',\r\n\t  account: {},\r\n    accounts: [],\r\n  \taccountId : '',\r\n    roles: [],\r\n    roless: [],\r\n    roleId: [],\r\n    text: '', \r\n    keyMaterialOrigin: 'Kms',\r\n    policy: {},\r\n    policys: [],\r\n    policyId : '',\r\n    users: [],\r\n    userss: [],\r\n    userId: [],\r\n    touched: {\r\n      alias: false,\r\n      accountId: false,\r\n      roleId: false,\r\n      keyMaterialOrigin: false,\r\n      policyId : false,\r\n      userId: false\r\n      \r\n    }\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      item: this.emptyItem\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.handleBlur = this.handleBlur.bind(this);\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (this.props.match.params.id !== 'new') {\r\n\r\n      const kms = await (await fetch(`${API_BASE_URL}/kmss/${this.props.match.params.id}`)).json();\r\n      kms.touched = {\r\n        alias: false,\r\n        accountId: false,\r\n        roleId: false,\r\n        keyMaterialOrigin: false,\r\n        policyId : false,\r\n        userId: false\r\n      };\r\n      this.setState({item: kms});\r\n\r\n      let account={};\r\n      await (await fetch(API_BASE_URL + \"/accounts/\" + kms.account.id,)\r\n      .then((result) => {\r\n        return result.json();\r\n      }).then((jsonResult) => {\r\n        account = jsonResult;\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/roles',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.roless = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/users',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.userss = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/policys',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.policys = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n      }));\r\n      \r\n      let item = {...this.state.item};\r\n      item.accountId = kms.account.id;\r\n      item.policyId = kms.policy.id;\r\n      var values = [];\r\n      if(item.roles) item.roles.map(s => { \r\n        values.push({\"id\": s.id});\r\n      });\r\n      item.roles = values;\r\n\r\n      values = [];\r\n      if(item.users) item.users.map(s => { \r\n        values.push({\"id\": s.id});\r\n      });\r\n      item.users = values;\r\n\r\n      values = [];\r\n      if(item.policys) item.policys.map(s => { \r\n        values.push({\"id\": s.id});\r\n      });\r\n      item.policys = values;\r\n      \r\n      this.setState({item: item});\r\n      \r\n    }\r\n    else {\r\n      const kms = {\r\n        alias: '',\r\n        account: {},\r\n        accounts: [],\r\n        accountId : '',\r\n        roles: [],\r\n        roless: [],\r\n        roleId: [],\r\n        text: '', \r\n        keyMaterialOrigin: 'Kms',\r\n        policy: {},\r\n        policys: [],\r\n        policyId : '',\r\n        touched: {\r\n          alias: false,\r\n          accountId: false,\r\n          roleId: false,\r\n          keyMaterialOrigin: false,\r\n          policyId : false,\r\n          userId: false\r\n        }\r\n      };\r\n      kms.touched = {\r\n          alias: false,\r\n          accountId: false,\r\n          roleId: false,\r\n          keyMaterialOrigin: false,\r\n          policyId : false,\r\n          userId: false\r\n      };\r\n      this.setState({item: kms});\r\n    }\r\n\r\n    await fetch(API_BASE_URL + '/accounts',)\r\n    .then((result) => {\r\n      return result.json();\r\n    }).then((jsonResult) => {\r\n      let item = {...this.state.item};\r\n      item.accounts = jsonResult;\r\n      this.setState({item: item});\r\n    })\r\n\r\n  }\r\n\r\n  handleChange(event) {\r\n    const target = event.target;\r\n    const value = target.value;\r\n    const name = target.name;\r\n    let item = {...this.state.item};\r\n    item[name] = value;\r\n    this.setState({item});\r\n     \r\n    if(name === 'accessType')\r\n    {\r\n      if(value === 'Kms'){\r\n        item.keyMaterialOrigin = 'Kms';\r\n      }\r\n      else\r\n      {\r\n        item.keyMaterialOrigin = 'External';\r\n      }\r\n    }\r\n   \r\n    if(name === 'accountId')\r\n    {\r\n\r\n      let account={};\r\n      fetch(API_BASE_URL + \"/accounts/\" + item.accountId,)\r\n      .then((result) => {\r\n        return result.json();\r\n      }).then((jsonResult) => {\r\n        account = jsonResult;\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/roles',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.roless = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/users',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.userss = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n        fetch(API_BASE_URL + '/accounts/' + (account.id) + '/policys',)\r\n        .then((result) => { \r\n          return result.json();\r\n        }).then((jsonResult) => {\r\n          let item = {...this.state.item};\r\n          item.policys = jsonResult;\r\n          this.setState({item: item});\r\n        });\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  async handleSubmit(event) {\r\n    event.preventDefault();\r\n    const {item} = this.state;\r\n\r\n    item.touched = {\r\n      alias: true,\r\n      accountId: true,\r\n      roleId: true,\r\n      keyMaterialOrigin: true,\r\n      policyId : true,\r\n      userId: true\r\n    };\r\n    const errors = this.validate(item.alias, item.accountId, item.roleId, item.keyMaterialOrigin, item.policyId, item.userId);\r\n\r\n    const isDisabled = Object.keys(errors).some(x => errors[x]);\r\n    if(isDisabled) {\r\n        this.forceUpdate();\r\n        return;\r\n    }\r\n    \r\n    const hist= API_BASE_URL + '/kmss'; \r\n\r\n    item.account={id: item.accountId};\r\n    item.policy={id: item.policyId};\r\n\r\n\r\n    var values = [];\r\n      item.users.map(s => { \r\n        values.push({\"id\": s.id});\r\n      });\r\n      item.users = values;\r\n\r\n    var values = [];\r\n      item.roles.map(s => { \r\n        values.push({\"id\": s.id});\r\n      });\r\n      item.roles = values;\r\n\r\n    await fetch((item.id) ? API_BASE_URL + '/accounts/' + (item.account.id) + '/kmss/'+(item.id) : API_BASE_URL + '/accounts/' + item.account.id + '/kmss', {\r\n      method: (item.id) ? 'PUT' : 'POST',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(item),\r\n    });\r\n    this.props.history.push(hist);\r\n  }\r\n\r\n  handleBlur = (field) => (evt) => {\r\n\r\n    let item = {...this.state.item};\r\n    item.touched= { ...this.state.item.touched, [field]: true};\r\n    this.setState({item});\r\n\r\n  }\r\n\r\n  validate(alias, accountId,  roleId, keyMaterialOrigin, policyId, userId) {\r\n\r\n    const errors = {\r\n      alias: '',\r\n      accountId: '',\r\n      roleId: '',\r\n      keyMaterialOrigin: '',\r\n      policyId: '',\r\n      userId: ''\r\n    };\r\n    \r\n\r\n    if(this.state.item.touched.alias && alias.length === 0){\r\n      errors.alias = 'alias should not be null';\r\n      return errors;\r\n    }\r\n    \r\n    if(this.state.item.touched.accountId && accountId.length === 0){\r\n      errors.accountId = 'Vpc should not be null';\r\n      return errors;\r\n    }\r\n\r\n    if(this.state.item.touched.keyMaterialOrigin && keyMaterialOrigin.length === 0){\r\n      errors.keyMaterialOrigin = 'keyMaterialOrigin should not be null';\r\n      return errors;\r\n    }\r\n/*\r\n    if(this.state.item.touched.userId && userId.length === 0){\r\n      errors.userId = 'userId should not be null';\r\n      return errors;\r\n    }\r\n    */ \r\n    if(this.state.item.touched.policyId && policyId.length === 0){\r\n      errors.policyId = 'policyId should not be null';\r\n      return errors;\r\n    }\r\n    /*\r\n    if(this.state.item.touched.roleId  && this.state.item.roles.length === 0){\r\n      errors.roleId = 'Add roleId.';\r\n      return errors;\r\n    }\r\n*/  \r\n    return errors;\r\n  }\r\n\r\n\r\n  onOptionChange = (selectName,selectedOption) => {\r\n      const {item} = this.state;\r\n      var options = selectedOption;\r\n      var values = [];\r\n      if(selectName === 'roleId') \r\n      {\r\n        for (var i = 0, l = options.length; i < l; i++) {      \r\n          if(item.roless && item.roless.length){\r\n              item.roless.map(s => { \r\n                if(s.id == options[i].value) {\r\n                    values.push({\"id\": s.id});\r\n                }\r\n            });\r\n          }\r\n        }\r\n        item.roles = values;\r\n      }\r\n      if(selectName === 'userId') \r\n      {\r\n        for (var i = 0, l = options.length; i < l; i++) {      \r\n          if(item.userss && item.userss.length){\r\n              item.userss.map(s => { \r\n                if(s.id == options[i].value) {\r\n                    values.push({\"id\": s.id});\r\n                }\r\n            });\r\n          }\r\n        }\r\n        item.users = values;\r\n      }\r\n      \r\n      this.setState({item});\r\n  };\r\n\r\n\r\n  render() {\r\n    const {item} = this.state;\r\n    const title = <h2>{item.id ? 'Edit Kms' : 'Add Kms'}</h2>;\r\n\r\n    const errors = this.validate(item.alias, item.accountId, item.roleId, item.keyMaterialOrigin, item.policyId, item.userId);\r\n    const isDisabled = Object.keys(errors).some(x => errors[x]);\r\n    \r\n    const canc = API_BASE_URL + \"/kmss\";\r\n\r\n    \r\n    let opts = [];\r\n    if(item.accounts && item.accounts.length){\r\n      item.accounts.map(s => {  \r\n          opts.push(<option value={s.id}>{s.id} {s.name}</option>);\r\n      });\r\n    }\r\n    let account = item.accountId || '';\r\n    item.accountId = account;\r\n\r\n    let isUsed = false; \r\n    //if(item.id !== '' && (item.kmss && item.kmss.length !== 0)  ) isUsed = true; \r\n    \r\n    let optsp = [];  \r\n    let optsps = [];\r\n    if(item.roless && item.roless.length){\r\n      item.roless.map(s => {  \r\n          if(item.roles && item.roles.length) item.roles.map(ss => {\r\n             if(s.id == ss.id) {\r\n               optsp.push({value: s.id, label: s.name});\r\n             }\r\n          });\r\n          optsps.push({value: s.id, label: s.name});\r\n      });\r\n    }\r\n\r\n    let optsu = [];  \r\n    let optsus = [];\r\n    if(item.userss && item.userss.length){\r\n      item.userss.map(s => {  \r\n          if(item.users && item.users.length) item.users.map(ss => {\r\n             if(s.id == ss.id) {\r\n               optsu.push({value: s.id, label: s.name});\r\n             }\r\n          });\r\n          optsus.push({value: s.id, label: s.name});\r\n      });\r\n    }\r\n    \r\n    let optpolicys = [];\r\n    if(item.policys && item.policys.length){\r\n      item.policys.map(s => {  \r\n          optpolicys.push(<option value={s.id}>{s.id} {s.name}</option>);\r\n      });\r\n    }\r\n    let policy = item.policyId || '';\r\n    item.policyId = policy;\r\n\r\n    return <div>\r\n      <AppNavbar/>\r\n      <Container>\r\n        {title}\r\n \r\n        <Form onSubmit={this.handleSubmit}>\r\n          <FormGroup>\r\n            <Label for=\"alias\">Alias (*)</Label> \r\n            <Input type=\"text\" name=\"alias\" id=\"alias\" value={item.alias || ''} placeholder=\"Enter alias\" disabled={isUsed}\r\n                   onChange={this.handleChange} onBlur={this.handleBlur('alias')} autoComplete=\"alias\"\r\n                   valid={errors.alias === ''}\r\n                   invalid={errors.alias !== ''}\r\n            />\r\n           \r\n           <FormFeedback>{errors.alias}</FormFeedback>\r\n          </FormGroup>\r\n\r\n          <FormGroup>\r\n            <Label for=\"accountId\">Account (*)</Label>\r\n            <Input type=\"select\" name=\"accountId\" id=\"accountId\"  value={account} onChange={this.handleChange} onBlur={this.handleBlur('accountId')} disabled={isUsed}\r\n                 valid={errors.accountId === ''}\r\n                 invalid={errors.accountId !== ''}\r\n            >\r\n              <option value=\"\" disabled>Choose</option>\r\n              {opts}\r\n            </Input>\r\n            <FormFeedback>{errors.accountId}</FormFeedback>\r\n          </FormGroup>\r\n\r\n\r\n          <FormGroup>\r\n            <Label for=\"policyId\">Policy (*)</Label>\r\n            <Input type=\"select\" name=\"policyId\" id=\"policyId\"  value={policy} onChange={this.handleChange} onBlur={this.handleBlur('policyId')} disabled={isUsed}\r\n                 valid={errors.policyId === ''}\r\n                 invalid={errors.policyId !== ''}\r\n            >\r\n              <option value=\"\" disabled>Choose</option>\r\n              {optpolicys}\r\n            </Input>\r\n            <FormFeedback>{errors.policyId}</FormFeedback>\r\n          </FormGroup>\r\n\r\n          <FormGroup>\r\n            <Label for=\"roleId\">Roles</Label>\r\n            <Select name=\"roleId\" id=\"roleId\"  placeholder=\"Enter roleId\" isMulti disabled={isUsed}\r\n              value={optsp}\r\n              onChange={e => this.onOptionChange(\"roleId\",e)}\r\n              onBlur={this.handleBlur('roleId')}\r\n              options={optsps}\r\n\r\n            />\r\n            <FormFeedback>{errors.roleId}</FormFeedback> \r\n          </FormGroup>\r\n\r\n          <FormGroup>\r\n            <Label for=\"userId\">Users</Label>\r\n            <Select name=\"userId\" id=\"userId\"  placeholder=\"Enter userId\" isMulti disabled={isUsed}\r\n              value={optsu}\r\n              onChange={e => this.onOptionChange(\"userId\",e)}\r\n              onBlur={this.handleBlur('userId')}\r\n              options={optsus}\r\n            />\r\n            <FormFeedback>{errors.userId}</FormFeedback> \r\n          </FormGroup>\r\n\r\n           <FormGroup tag=\"fieldset\">\r\n            <Label for=\"accessType\">Key Material Origin</Label>\r\n\r\n            <FormGroup check>\r\n              <Label check>\r\n                <Input type=\"radio\" name=\"accessType\" id=\"accessType\" value=\"Kms\" checked={item.keyMaterialOrigin === 'Kms'}\r\n                       onChange={this.handleChange} onBlur={this.handleBlur('accessType')} autoComplete=\"accessType\"\r\n                       valid={errors.accessType === ''}\r\n                       invalid={errors.accessType !== ''}\r\n                />{' '}\r\n                Kms\r\n              </Label>\r\n            </FormGroup>\r\n            <FormGroup check>\r\n              <Label check>\r\n                <Input type=\"radio\" name=\"accessType\" id=\"accessType\" value=\"External\" checked={item.keyMaterialOrigin === 'External'}\r\n                       onChange={this.handleChange} onBlur={this.handleBlur('accessType')} autoComplete=\"accessType\"\r\n                       valid={errors.accessType === ''}\r\n                       invalid={errors.accessType !== ''}\r\n                />{' '}\r\n                External\r\n              </Label>\r\n            </FormGroup>\r\n            \r\n            <FormFeedback>{errors.accessType}</FormFeedback>\r\n          </FormGroup>\r\n\r\n\r\n          <FormGroup>\r\n            <Label for=\"text\">Description</Label> \r\n            <Input type=\"text\" name=\"text\" id=\"text\" value={item.text || ''} placeholder=\"Enter text\" disabled={isUsed}\r\n                   onChange={this.handleChange} onBlur={this.handleBlur('text')} autoComplete=\"text\"\r\n                  \r\n            />\r\n          </FormGroup>\r\n          \r\n          \r\n            \r\n\r\n\r\n          <FormGroup>\r\n            <Button color=\"primary\" type=\"submit\" disabled={isDisabled}>Save</Button>{' '}\r\n            <Button color=\"secondary\" tag={Link} to={canc}>Cancel</Button>\r\n          </FormGroup>\r\n        </Form>\r\n      </Container>\r\n    </div>\r\n  }\r\n}\r\n\r\nexport default withRouter(KmsEdit);"]},"metadata":{},"sourceType":"module"}